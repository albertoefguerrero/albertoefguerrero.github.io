<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-12-18 vie 14:12 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Final Challenge</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Alberto Flores" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Final Challenge</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org557b903">1. - Kanban</a></li>
<li><a href="#orge6c1a23">2. - Architecture Diagram</a></li>
<li><a href="#org0e6ad66">3. - Process Flow</a></li>
<li><a href="#org42b8085">4. - Repository</a></li>
<li><a href="#org377aaf2">5. Learn about go toolchain</a></li>
<li><a href="#org635e310">6. Play with code from repository</a></li>
<li><a href="#org7f3d2a8">7. Jenkins with Go</a></li>
<li><a href="#orgc68d724">8. Installing and running Docker on CentOS 7</a></li>
<li><a href="#org58df2f5">9. Building Dockerfile and running</a></li>
<li><a href="#orgbf0aebc">10. Fixed Dockerfile</a></li>
<li><a href="#orge36dd13">11. Jenkins with BlueOcean</a>
<ul>
<li><a href="#orge679ed8">11.1. Installing with docker</a></li>
<li><a href="#org1a84f26">11.2. Webhook</a></li>
<li><a href="#org93ec43d">11.3. Creating a Pipeline</a></li>
</ul>
</li>
<li><a href="#orged1c232">12. DO NOT USE. Creating a custom Dockerfile with Jenkins, BlueOcean, Go and dependencies</a></li>
<li><a href="#orga57fa77">13. Custom Dockerfile with Jenkins BlueOcean and Docker</a>
<ul>
<li><a href="#orgf1f39d5">13.1. Running Custom Docker image</a></li>
<li><a href="#orgfb943be">13.2. This will create a new Jenkins instance, we have to setup credentials again.</a></li>
<li><a href="#org576cb7b">13.3. Crate an image out of custom image with all credentials</a></li>
<li><a href="#org86ed2ff">13.4. jenkins with docker https://medium.com/@karthi.net/docker-tutorial-build-docker-images-using-jenkins-d2880e65b74</a></li>
<li><a href="#orgef91235">13.5. Integrating SonarQube and Jenkins https://aspiresoftware.in/blog/intergrating-sonarqube-and-jenkins/</a></li>
<li><a href="#org8960ee3">13.6. SonarScanner for Jenkins https://docs.sonarqube.org/latest/analysis/scan/sonarscanner-for-jenkins/</a></li>
<li><a href="#org53447db">13.7. Try Out SonarQube https://docs.sonarqube.org/latest/setup/get-started-2-minutes/</a></li>
<li><a href="#org9c1a9f4">13.8. Dockerhub - SonarQube https://hub.docker.com/_/sonarqube/</a></li>
<li><a href="#org8921385">13.9. SonarQube - Docker installation https://techexpert.tips/sonarqube/sonarqube-docker-installation/</a></li>
<li><a href="#orgc24eaf6">13.10. Prerequisites and Overview https://docs.sonarqube.org/latest/requirements/requirements/</a></li>
<li><a href="#org5fddd8e">13.11. <span class="todo TODO">TODO</span> Keep the app running</a></li>
<li><a href="#orgf7def90">13.12. <span class="todo TODO">TODO</span> Docker code in an external</a></li>
</ul>
</li>
<li><a href="#org857e848">14. Sonar Qube</a>
<ul>
<li><a href="#orgda6d047">14.1. Sonar Scanner</a></li>
</ul>
</li>
<li><a href="#orge3b9a31">15. Share directories across docker images</a></li>
<li><a href="#orgcbcda05">16. Fixing Code</a></li>
<li><a href="#org6b9bd4c">17. Securing jenkins</a></li>
<li><a href="#org55fa451">18. Coverage</a></li>
<li><a href="#org1516c17">19. Junit testing for Jenkins</a></li>
<li><a href="#org2c9672a">20. Publishing</a>
<ul>
<li><a href="#orgd464b80">20.1. NO longer possible to run binary only</a></li>
</ul>
</li>
<li><a href="#org31c7e75">21. - Notes</a></li>
</ul>
</div>
</div>
<div id="outline-container-org557b903" class="outline-2">
<h2 id="org557b903"><span class="section-number-2">1</span> - Kanban</h2>
<div class="outline-text-2" id="text-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">TODO</th>
<th scope="col" class="org-left">Doing</th>
<th scope="col" class="org-left">Done</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Learn about Architecture Diagrams</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Design Processes Diagram</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Design Information Flow</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Clone Repository</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Install docker, git and go</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Learn about Go toolchain</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Play with code from repository</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Run code and tests on docker</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Fix Docker image</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Docker: Jenkins and BlueOcean</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Simple BlueOcean pipeline</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Pipeline: Build step</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Pipeline: Testing step</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Custom docker image with Go</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Jenkins Webhook</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Learn about Sonar Qube</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Install sonarqube</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Integrate Sonar Qube</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Jenkins for Docker Orchestration</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Everything in Docker !!</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Linting and formatting</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">CV</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Secure Jenkins</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Fix the code</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">JUnit test reporting for Jenkins</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">Publishing to github</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-orge6c1a23" class="outline-2">
<h2 id="orge6c1a23"><span class="section-number-2">2</span> - Architecture Diagram</h2>
<div class="outline-text-2" id="text-2">
<p>
<a href="https://viewer.diagrams.net/?highlight=0000ff&amp;edit=_blank&amp;layers=1&amp;nav=1#R7Zpbc9o4FIB%2FDY94bMk3Hkko6ex0u92mne4%2BZYQtsIptsbYosL9%2BJSyBJYtAOsCQbfIQ5GMhi3M%2BnYvkHrwv1g8VWmS%2F0xTnPeCm6x4c9QCIvJD%2FF4JNI4CxFMwqkjYiby94JP9iKXSldElSXGsdGaU5IwtdmNCyxAnTZKiq6ErvNqW5%2FtQFmuGO4DFBeVf6jaQsa6Rx4O7l7zGZZerJnivvFEh1loI6QyldtUTwXQ%2FeV5SyplWs73EudKf00nxvfODubmIVLtkpX2AYF%2BMP7CPJv26KhCTf1mTel6P8QPlS%2FmA5WbZRGqjoskyxGMTtwbtVRhh%2BXKBE3F1xk3NZxoqcX3m82Z2UegKuGF63RHKSD5gWmFUb3kXeBb5U2EaRIK9Xe%2F0HSqlZS%2FcglEIkbT7bjb1XC29IzbxAS%2FC4llJUZzsl0SXLSYnvd0y6upZQTmYlbydcS7jighxNcP6J1oQRqt0QaiOcxg9GhwlljBatDkM5JKPCIpy1hZhYsZ6JVems8CSnM1o7M8Ky5eQMVop0I3GLOEHHTFHQtZKSnd1IvsVIYc6fejel%2FGe2rRX%2Bs6TqRr%2Fe%2Bpwh7%2BDFi%2FX%2BJm%2FN5Od2lIkSPBD2XugwRIXQdTmpF61ufO4T86tc1sxBiQ14uM6ZTkjNKjrnAOWUUzAqaYnFdEmeG6IOSSYPBUlT8RjrwtWXtpiiGr4HIBjBgDfOsqa90AGBBgwEkQUYL95hpK3sSy3s4PjCVktpmuP1UAQUrhFcprI5SnJU1yTRrad%2BEXR8P%2BbExyFww3gQBlHzZRnmQifUbofPKZuhaobZcSeFUy2gdU3SdqMWL6pkFc4RIz%2F0MGgzgHzCJ0q2q0x5cWg4iIExRE2XVYLlt9phyxjID8yBDBgaxXQG2vKw%2B9k%2Fj0h4OiKk2CYTbRLs7vmoV9%2FGgzuUzGfbJdpaldPtH%2B%2ByfdiwXuwDDFIXU7IWi%2FpOzmeUMSaypaHQDRgnaek7hOdLU8IXf%2BUk%2FIlgnCKG%2BIeQ1%2FxzGy36kwqVaS1WyRhw9zr%2Bjss5Keu%2BB2JnUc4u6zP8wHcC34gyA4vTCOMuxUp2do8RHYsy08bD7uPIF1LwBBa4H%2FGK%2F%2F9MC1S2g8zxsAT8k8LSb41x3uLQc0yFscmUPRD5tvzyUlFocJCpjgUPQfaZFywrtNHAEku637BUJVpv3SGILjwzpHSWY7QgtfQISc27jKeoILlQleUJzdQ%2BLSc5qbODjNlwvEnuzpHnxGZabHNYV4VLFdLPBTBrvaKbgC9E6PmQLx54p9U6P1mhdAzXMr7gR6ZIHlDXcrbWQLcQwR9X737wwWpFkFECoVXtO0mGkzmnlT0ltFbryRZd26id2QcFBiNe0K1vI0tIiy4V0rwTNgEOaLjZ0HBNJo4t5HOXu1Z%2BO4SZRNDplCSYe7sywQvuAfmsLmt53w8cPxjs%2F3QO%2FLDLQeS4FhRicCkUTtjpeHXZrns0261pQlDeL3BKUB94rq8S3ubG0%2FbGk3YhEuSnlCZzXLXT4cvBA13DbcDYEloGUZcWJTs%2FLbbExaDlWKmM14T91Wr%2FLc0r2qN1%2B2JzLEw3FeUz85Xr62glrULmjZTScKBbHkIjVzi5lDZ2VkF83VIanJCKnMqLy%2BG%2FIWK8myImAFA3tLkzfioxcBDrA4HAcQMvgnAAB9HuLOda%2FJyQqJzMzy3Rc1tbd37oOwFspSmhAdOupnnlOAELTq%2Bn7n6kJar44%2F5cTvBb8S3wN86kPM%2BWIcXXLL6BLZ9%2BPYh9LYmY0hdcM8Lz2zfIRA7l3xxkh08%2BXwNko20R9QaXiI%2FuDiaFF%2BhuClwXrhcckb7tCFx1RyDyjLoQdDcSbayYVd%2F5WDl6OPbis66b8lTDKhFeIGHLCj%2Fz%2BsevfcQGjN0KvwvlVc8%2FQHwMyltCTE2NKMHdplkYw3zCTUB5a8zNhtvHvMQSLH9xBoHOYNRl0LsUhA%2F11zV4HMzjbH4%2FSdkf7rj%2B3n%2FdleY3PMkonf9fUrQORxbaDp%2FwRmbQvebrA1a4XnBmc6WX2NoHtnIyxt7WSSq%2FznaXFxxIo166u2W%2B8tYZ6Kf3s%2Fjl%2Fj3xpvv%2BZXv47j8%3D">Link to architecture diagram in Diagrams.net</a>
</p>


<div id="org181da1f" class="figure">
<p><img src="images/diagram.png" alt="diagram.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org0e6ad66" class="outline-2">
<h2 id="org0e6ad66"><span class="section-number-2">3</span> - Process Flow</h2>
<div class="outline-text-2" id="text-3">
<p>
<a href="https://viewer.diagrams.net/?highlight=0000ff&amp;edit=_blank&amp;layers=1&amp;nav=1#R3Vhdb9owFP01PHbKBwnwWAhtpalSK7aV7mUyySXxcOLIcUror5%2BTOOTDMBgbYpQH8D2Ob%2Bxz7rFJeuYkzO4ZioNH6gHpGZqX9UynZxjWyBTfObApAVMflYDPsFdCeg3M8DtIUJNoij1IWhdySgnHcRt0aRSBy1sYYoyu25ctKWnfNUY%2BKMDMRURFX7DHgxIdWlqNPwD2g%2BrOuiZ7QlRdLIEkQB5dNyBz2jMnjFJetsJsAiTnruKlHHe3p3c7MQYRP2bAc2Y%2BvA7ujK%2BB8zN7%2F6G%2FT5L5jczyhkgqFywnyzcVAyKLIFsE43WAOcxi5OY9ayG3wAIeEhHpoomSuFRgiTMQNx0vMSETSigrEpkeguHSFXjCGV1Bo8d2h7BYih51TdUEgXHIGpBc4z3QEDjbiEtkb0W3rDfdlvG6Vq8SL2gIV2FI1ou%2FTVxTKhqS1T9g2DyC4ci7zUtVRC5BSYLdNrF7WQGvVbwqJ0cumgFBHL%2B1S34XE%2FIOTxSLmWwpH3QoH%2FY%2FWe0cCU2ZC3JYs0Y7mXT9YCqOmA9cSVVos1356XJZilxPaTFqyWjYM2wU5lUfLZK4EMYmgsrxgomWn7fuMQ%2FSRUFpTNXutejOZYFFQOlKKQRG08jLreNoh%2B12EXcpAlmWYi%2Fd2FFq9rn8ZX98fxmm6orhaQbb5dVOqjMbbKDoNU6xOJTFBOK49lnHOOX6RHea4MgXvw51V8CEB0A15dW5SlHl4q4afnxXmSPVCgNbqz%2FGaRbr73Dr7%2FKe2W8jRclpBq5AvkDCCy9dnV0Uhi9ul%2BpU7LCccigeTbz8B0WIbBKcFPPM%2FwZ097juRjajERKd2nO6gCtUyer66%2FIq9f9%2BV4MM83mj%2FZorIP6jlpGTSUGKYFMFkZj9vBk0RuVhPayIqnF7RZCn4UHTl1vLEXX7n2zJfa1dMsawUwpH78FWJ5HZSfTvNt3bF%2Fxtvvo%2BeXt0gudHbDvM%2FnxjXGOhdYpgR%2BVd7AFzx2PhwD6tNAbW4Vxnrg71lcBHOCyUk%2BGoAtqnyhkPCxHWb91KTetXl%2Bb0Fw%3D%3D">Link to process flow in Diagrams.net</a>
</p>


<div id="orgc579c6b" class="figure">
<p><img src="images/process-flow.png" alt="process-flow.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-org42b8085" class="outline-2">
<h2 id="org42b8085"><span class="section-number-2">4</span> - Repository</h2>
<div class="outline-text-2" id="text-4">
<p>
<a href="https://github.com/albertoefguerrero/DOTT">https://github.com/albertoefguerrero/DOTT</a>
</p>
</div>
</div>

<div id="outline-container-org377aaf2" class="outline-2">
<h2 id="org377aaf2"><span class="section-number-2">5</span> Learn about go toolchain</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>Setting up GO environment variables (should be done with root)</li>
</ul>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #29838D;">export</span> <span style="color: #842879;">GOPATH</span>=~/go
<span style="color: #29838D;">export</span> <span style="color: #842879;">GOBIN</span>=$<span style="color: #842879;">GOPATH</span>/bin
<span style="color: #29838D;">export</span> <span style="color: #842879;">PATH</span>=$<span style="color: #842879;">PATH</span>:$<span style="color: #842879;">GOBIN</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org635e310" class="outline-2">
<h2 id="org635e310"><span class="section-number-2">6</span> Play with code from repository</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>Proper goop repository is <code>~github.com/karmakaze/goop</code>. Should change in Dockerfile</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">go get github.com/karmakaze/goop <span style="color: #8b94a5;"># </span><span style="color: #8b94a5;">should be run as root</span>
goop install
goop go run api.go convert.go
</pre>
</div>


<ul class="org-ul">
<li>Ash is the alpine shell</li>

<li>The port is defined in <code>main()</code> in line 66 of file api.go, this should be a variable, not hardcoded</li>
</ul>
<div class="org-src-container">
<pre class="src src-go">log.<span style="color: #29838D;">Fatal</span>(http.<span style="color: #29838D;">ListenAndServe</span>(<span style="color: #4F894C;">":8000"</span>, router))
</pre>
</div>

<ul class="org-ul">
<li>Test are run like this</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">go get github.com/stretchr/testify/assert
goop go test
</pre>
</div>
</div>
</div>

<div id="outline-container-org7f3d2a8" class="outline-2">
<h2 id="org7f3d2a8"><span class="section-number-2">7</span> Jenkins with Go</h2>
<div class="outline-text-2" id="text-7">
<p>
<a href="https://plugins.jenkins.io/golang/">https://plugins.jenkins.io/golang/</a>
</p>
</div>
</div>

<div id="outline-container-orgc68d724" class="outline-2">
<h2 id="orgc68d724"><span class="section-number-2">8</span> Installing and running Docker on CentOS 7</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-shell">sudo yum -y update
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
sudo yum install docker-ce docker-ce-cli containerd.io
sudo systemctl start docker
<span style="color: #8b94a5;"># </span><span style="color: #8b94a5;">sudo docker run hello-world # only to test</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org58df2f5" class="outline-2">
<h2 id="org58df2f5"><span class="section-number-2">9</span> Building Dockerfile and running</h2>
<div class="outline-text-2" id="text-9">
<div class="org-src-container">
<pre class="src src-shell">docker build -t gom .
docker run -ti -p 8000:8000 gom
</pre>
</div>

<p>
exec commands
</p>
<pre class="example">
docker exec -it &lt;container&gt; &lt;command&gt;
</pre>
</div>
</div>

<div id="outline-container-orgbf0aebc" class="outline-2">
<h2 id="orgbf0aebc"><span class="section-number-2">10</span> Fixed Dockerfile</h2>
<div class="outline-text-2" id="text-10">
<p>
Testify required Go 1.13+ so using a newer image of golang
Mux required GCC so it was added too
</p>

<div class="org-src-container">
<pre class="src src-Dockerfile">FROM golang:1.15-alpine

ENV GOPATH=/go:/app
RUN apk add --update git
RUN apk add build-base
WORKDIR /app

COPY Goopfile Goopfile
RUN go get github.com/karmakaze/goop \
    &amp;&amp; go get github.com/gorilla/mux \
    &amp;&amp; go get github.com/stretchr/testify/assert \
    &amp;&amp; goop install

COPY . .
CMD ["ash", "-c", "goop go run api.go convert.go"]
# docker build -t gom .
# docker run -ti -p 8000:8000 gom
</pre>
</div>
</div>
</div>

<div id="outline-container-orge36dd13" class="outline-2">
<h2 id="orge36dd13"><span class="section-number-2">11</span> Jenkins with BlueOcean</h2>
<div class="outline-text-2" id="text-11">
<p>
It is really easy to create a Pipeline with Jenkins and BlueOcean
</p>
</div>

<div id="outline-container-orge679ed8" class="outline-3">
<h3 id="orge679ed8"><span class="section-number-3">11.1</span> Installing with docker</h3>
<div class="outline-text-3" id="text-11-1">
<p>
We can install BlueOcean and jenkins with Docker
</p>
<div class="org-src-container">
<pre class="src src-shell">docker run -p 8080:8080 jenkinsci/blueocean
</pre>
</div>

<p>
-The documentation for <a href="https://hub.docker.com/r/jenkinsci/blueocean">the blue ocean docker</a>
</p>
</div>
</div>

<div id="outline-container-org1a84f26" class="outline-3">
<h3 id="org1a84f26"><span class="section-number-3">11.2</span> Webhook</h3>
<div class="outline-text-3" id="text-11-2">
<ul class="org-ul">
<li><a href="https://dzone.com/articles/adding-a-github-webhook-in-your-jenkins-pipeline">Adding a GitHub Webhook in Your Jenkins Pipeline</a></li>
<li><a href="https://jayd.ml/jenkins/2019/03/05/jenkins-pipeline-webhooks.html">How to get Jenkins Blue Ocean Github Webhooks to Work</a></li>
<li><a href="https://medium.com/@joydeep56053/continuous-integration-using-jenkins-blueocean-github-ubuntu-robotframework-5b800ae1df8c">Continuous Integration using Jenkins BlueOcean + Github + Ubuntu &amp; Robot Framework</a></li>

<li><a href="https://plugins.jenkins.io/multibranch-scan-webhook-trigger/">Plugin for webhook</a></li>

<li>Example of URL with token named token-test</li>
</ul>
<pre class="example">
http://3.129.89.220:8081/multibranch-webhook-trigger/invoke?token=token-test
</pre>
</div>
</div>


<div id="outline-container-org93ec43d" class="outline-3">
<h3 id="org93ec43d"><span class="section-number-3">11.3</span> Creating a Pipeline</h3>
<div class="outline-text-3" id="text-11-3">
<ul class="org-ul">
<li><a href="https://www.jenkins.io/doc/book/blueocean/creating-pipelines/">Creating a Pipeline with BlueOcean</a></li>
<li><a href="https://www.jenkins.io/doc/book/blueocean/pipeline-editor/">BlueOcean Pipeline Editor</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token">Documentation to create a Github personal access token</a></li>
<li><a href="https://www.jenkins.io/doc/book/pipeline/syntax/">Jenkinsfile Pipeline syntax</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orged1c232" class="outline-2">
<h2 id="orged1c232"><span class="section-number-2">12</span> DO NOT USE. Creating a custom Dockerfile with Jenkins, BlueOcean, Go and dependencies</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-Dockerfile">FROM jenkinsci/blueocean
USER root
RUN apk add --no-cache git make musl-dev go

# Configure Go
ENV GOROOT /usr/lib/go
ENV GOPATH /go
ENV PATH /go/bin:$PATH
ENV GOBIN $GOPATH/bin

RUN mkdir -p ${GOPATH}/src ${GOPATH}/bin

RUN go get github.com/karmakaze/goop \
    &amp;&amp; go get github.com/gorilla/mux \
    &amp;&amp; go get github.com/stretchr/testify/assert \
    &amp;&amp; go get github.com/pkg/errors
</pre>
</div>

<p>
With inspiration from <a href="https://stackoverflow.com/a/53405005">here</a> and <a href="https://fukubaka0825.medium.com/how-to-resolve-the-trouble-occurred-when-i-install-go-into-the-alpine-image-3c1e84f2315a">here</a> and <a href="https://stackoverflow.com/a/56613664">here</a>
</p>
</div>
</div>


<div id="outline-container-orga57fa77" class="outline-2">
<h2 id="orga57fa77"><span class="section-number-2">13</span> Custom Dockerfile with Jenkins BlueOcean and Docker</h2>
<div class="outline-text-2" id="text-13">
<div class="org-src-container">
<pre class="src src-Dockerfile">FROM jenkinsci/blueocean
USER root
RUN apk add --no-cache git make musl-dev
RUN apk add --update docker openrc
RUN rc-update add docker boot
RUN addgroup username docker
RUN apk add docker-compose
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">docker run -it -v <span style="color: #4F894C;">"/var/run/docker.sock:/var/run/docker.sock:rw"</span> image-name /bin/sh
</pre>
</div>

<p>
<a href="https://stackoverflow.com/questions/54099218/how-can-i-install-docker-inside-an-alpine-container">https://stackoverflow.com/questions/54099218/how-can-i-install-docker-inside-an-alpine-container</a>
<a href="https://wiki.alpinelinux.org/wiki/Docker#Installation">https://wiki.alpinelinux.org/wiki/Docker#Installation</a>
<a href="https://stackoverflow.com/questions/28302178/how-can-i-add-a-volume-to-an-existing-docker-container">https://stackoverflow.com/questions/28302178/how-can-i-add-a-volume-to-an-existing-docker-container</a>
</p>
</div>

<div id="outline-container-orgf1f39d5" class="outline-3">
<h3 id="orgf1f39d5"><span class="section-number-3">13.1</span> Running Custom Docker image</h3>
<div class="outline-text-3" id="text-13-1">
<ul class="org-ul">
<li>To create the image we do (Make sure the Dockerfile is in path)</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">docker build -t custom .
</pre>
</div>

<ul class="org-ul">
<li>To run the image we do</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">docker run -p 8000:8000 -p 8080:8080 custom
</pre>
</div>


<p>
export JAVA<sub>HOME</sub>=/opt/java/current &amp;&amp; export PATH=$PATH:$JAVA<sub>HOME</sub>/bin &amp;&amp;
</p>

<p>
export JAVA<sub>HOME</sub>=/usr/lib/jvm/java-11-openjdk &amp;&amp; export PATH="\(JAVA_HOME/bin:\){PATH}" &amp;&amp;
docker run &#x2013;network=host -e SONAR<sub>HOST</sub><sub>URL</sub>='http://albertoefg1c.mylabserver.com:9090' &#x2013;user="\((id -u):\)(id -g)" -v "$PWD:/usr/src" sonarsource/sonar-scanner-cli
</p>

<p>
<a href="http://pietervogelaar.nl/jenkinsfile-docker-pipeline-multi-stage">http://pietervogelaar.nl/jenkinsfile-docker-pipeline-multi-stage</a>
</p>

<p>
<a href="https://www.kabisa.nl/tech/running-multiple-docker-containers-in-parallel-with-jenkins/">https://www.kabisa.nl/tech/running-multiple-docker-containers-in-parallel-with-jenkins/</a>
</p>

<p>
<a href="https://stackoverflow.com/questions/49782267/running-multiple-docker-containers-from-a-single-jenkinsfile">https://stackoverflow.com/questions/49782267/running-multiple-docker-containers-from-a-single-jenkinsfile</a>
</p>
</div>
</div>

<div id="outline-container-orgfb943be" class="outline-3">
<h3 id="orgfb943be"><span class="section-number-3">13.2</span> This will create a new Jenkins instance, we have to setup credentials again.</h3>
</div>
<div id="outline-container-org576cb7b" class="outline-3">
<h3 id="org576cb7b"><span class="section-number-3">13.3</span> Crate an image out of custom image with all credentials</h3>
</div>

<div id="outline-container-org86ed2ff" class="outline-3">
<h3 id="org86ed2ff"><span class="section-number-3">13.4</span> jenkins with docker <a href="https://medium.com/@karthi.net/docker-tutorial-build-docker-images-using-jenkins-d2880e65b74">https://medium.com/@karthi.net/docker-tutorial-build-docker-images-using-jenkins-d2880e65b74</a></h3>
</div>

<div id="outline-container-orgef91235" class="outline-3">
<h3 id="orgef91235"><span class="section-number-3">13.5</span> Integrating SonarQube and Jenkins <a href="https://aspiresoftware.in/blog/intergrating-sonarqube-and-jenkins/">https://aspiresoftware.in/blog/intergrating-sonarqube-and-jenkins/</a></h3>
</div>
<div id="outline-container-org8960ee3" class="outline-3">
<h3 id="org8960ee3"><span class="section-number-3">13.6</span> SonarScanner for Jenkins <a href="https://docs.sonarqube.org/latest/analysis/scan/sonarscanner-for-jenkins/">https://docs.sonarqube.org/latest/analysis/scan/sonarscanner-for-jenkins/</a></h3>
</div>
<div id="outline-container-org53447db" class="outline-3">
<h3 id="org53447db"><span class="section-number-3">13.7</span> Try Out SonarQube <a href="https://docs.sonarqube.org/latest/setup/get-started-2-minutes/">https://docs.sonarqube.org/latest/setup/get-started-2-minutes/</a></h3>
</div>
<div id="outline-container-org9c1a9f4" class="outline-3">
<h3 id="org9c1a9f4"><span class="section-number-3">13.8</span> Dockerhub - SonarQube <a href="https://hub.docker.com/_/sonarqube/">https://hub.docker.com/_/sonarqube/</a></h3>
</div>
<div id="outline-container-org8921385" class="outline-3">
<h3 id="org8921385"><span class="section-number-3">13.9</span> SonarQube - Docker installation <a href="https://techexpert.tips/sonarqube/sonarqube-docker-installation/">https://techexpert.tips/sonarqube/sonarqube-docker-installation/</a></h3>
</div>
<div id="outline-container-orgc24eaf6" class="outline-3">
<h3 id="orgc24eaf6"><span class="section-number-3">13.10</span> Prerequisites and Overview <a href="https://docs.sonarqube.org/latest/requirements/requirements/">https://docs.sonarqube.org/latest/requirements/requirements/</a></h3>
<div class="outline-text-3" id="text-13-10">
<p>
Hardware Requirements
A small-scale (individual or small team) instance of the SonarQube server requires at least 2GB of RAM to run efficiently and 1GB of free RAM for the OS. If you are installing an instance for a large teams or Enterprise, please consider the additional recommendations below.
The amount of disk space you need will depend on how much code you analyze with SonarQube.
SonarQube must be installed on hard drives that have excellent read &amp; write performance. Most importantly, the "data" folder houses the Elasticsearch indices on which a huge amount of I/O will be done when the server is up and running. Great read &amp; write hard drive performance will therefore have a great impact on the overall SonarQube server performance.
SonarQube does not support 32-bit systems on the server side. SonarQube does, however, support 32-bit systems on the scanner side.
</p>
</div>
</div>
<div id="outline-container-org5fddd8e" class="outline-3">
<h3 id="org5fddd8e"><span class="section-number-3">13.11</span> <span class="todo TODO">TODO</span> Keep the app running</h3>
</div>
<div id="outline-container-orgf7def90" class="outline-3">
<h3 id="orgf7def90"><span class="section-number-3">13.12</span> <span class="todo TODO">TODO</span> Docker code in an external</h3>
</div>
</div>

<div id="outline-container-org857e848" class="outline-2">
<h2 id="org857e848"><span class="section-number-2">14</span> Sonar Qube</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-shell">docker run -d --name sonarqube <span style="color: #4F894C;">\</span>
    -p 9000:9000 <span style="color: #4F894C;">\</span>
    -e <span style="color: #842879;">SONAR_JDBC_URL</span>=... <span style="color: #4F894C;">\</span>
    -e <span style="color: #842879;">SONAR_JDBC_USERNAME</span>=... <span style="color: #4F894C;">\</span>
    -e <span style="color: #842879;">SONAR_JDBC_PASSWORD</span>=... <span style="color: #4F894C;">\</span>
    -v sonarqube_data:/opt/sonarqube/data <span style="color: #4F894C;">\</span>
    -v sonarqube_extensions:/opt/sonarqube/extensions <span style="color: #4F894C;">\</span>
    -v sonarqube_logs:/opt/sonarqube/logs <span style="color: #4F894C;">\</span>
    sonarqube
</pre>
</div>

<p>
docker run -d &#x2013;name sonarqube3 -p 9090:9000 -p 9092:9092 -v sonarqube-conf:/opt/sonarqube/conf -v sonarqube-data:/opt/sonarqube/data -v sonarqube-logs:/opt/sonarqube/logs -v sonarqube-extensions:/opt/sonarqube/extensions sonarqube
</p>
</div>

<div id="outline-container-orgda6d047" class="outline-3">
<h3 id="orgda6d047"><span class="section-number-3">14.1</span> Sonar Scanner</h3>
<div class="outline-text-3" id="text-14-1">
<div class="org-src-container">
<pre class="src src-shell">docker run --rm --network host <span style="color: #4F894C;">\</span>
       -e <span style="color: #842879;">SONAR_HOST_URL</span>=<span style="color: #4F894C;">"http://3.138.247.153/"</span> <span style="color: #4F894C;">\</span>
       -e <span style="color: #842879;">SONAR_LOGIN</span>=<span style="color: #4F894C;">"99a7536d3c88fc79e7f1dd189f99b4cf59926cc6"</span> <span style="color: #4F894C;">\</span>
       -v <span style="color: #4F894C;">"/var/jenkins_home/workspace/DOTT_master/cidr_convert_api/go/"</span> <span style="color: #4F894C;">\</span>
       sonarsource/sonar-scanner-cli -X
</pre>
</div>

<p>
&#x2013;network host -e SONAR<sub>HOST</sub><sub>URL</sub>="<a href="http://3.138.247.153/">http://3.138.247.153/</a>" -e SONAR<sub>LOGIN</sub>="99a7536d3c88fc79e7f1dd189f99b4cf59926cc6" -v "<i>var/jenkins<sub>home</sub>/workspace/DOTT<sub>master</sub>/cidr<sub>convert</sub><sub>api</sub>/go</i>"
</p>


<div class="org-src-container">
<pre class="src src-shell">sonar-scanner <span style="color: #4F894C;">\</span>
  -Dsonar.projectKey=test-key1 <span style="color: #4F894C;">\</span>
  -Dsonar.sources=. <span style="color: #4F894C;">\</span>
  -Dsonar.host.url=http://3.22.117.110 <span style="color: #4F894C;">\</span>
  -Dsonar.login=test
  -Dsonar.go.coverage.reportPaths=$<span style="color: #842879;">WORKSPACE</span>/coverage.out
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge3b9a31" class="outline-2">
<h2 id="orge3b9a31"><span class="section-number-2">15</span> Share directories across docker images</h2>
<div class="outline-text-2" id="text-15">
<p>
<a href="https://www.jenkins.io/doc/book/pipeline/docker/#caching-data-for-containers">https://www.jenkins.io/doc/book/pipeline/docker/#caching-data-for-containers</a>
when using the pipeline we should have
</p>
<pre class="example">
args '-v $HOME/.m2:/root/.m2'
</pre>

<p>
Notes: First directory is the host, second  directory is inside docker
If directories don't exists, jenkins will create them
</p>

<p>
<a href="https://docs.docker.com/storage/volumes/#choose-the--v-or---mount-flag">https://docs.docker.com/storage/volumes/#choose-the--v-or---mount-flag</a>
</p>
</div>
</div>




<div id="outline-container-orgcbcda05" class="outline-2">
<h2 id="orgcbcda05"><span class="section-number-2">16</span> Fixing Code</h2>
<div class="outline-text-2" id="text-16">
<ul class="org-ul">
<li>Integer to String <a href="https://golang.org/pkg/strconv/">https://golang.org/pkg/strconv/</a></li>
<li>Return only the first result of a multiple return values in golang <a href="https://stackoverflow.com/questions/53018490/return-only-the-first-result-of-a-multiple-return-values-in-golang">https://stackoverflow.com/questions/53018490/return-only-the-first-result-of-a-multiple-return-values-in-golang</a></li>

<li>Convert net mask into CIDR in Go <a href="https://stackoverflow.com/questions/57699732/convert-net-mask-into-cidr-in-go">https://stackoverflow.com/questions/57699732/convert-net-mask-into-cidr-in-go</a></li>

<li>Documentation for net library <a href="https://golang.org/pkg/net/">https://golang.org/pkg/net/</a></li>
<li>Golang Convert Cidr Address To Hosts <a href="https://www.stevencampbell.info/Golang-Convert-CIDR-Address-To-Hosts/">https://www.stevencampbell.info/Golang-Convert-CIDR-Address-To-Hosts/</a></li>
<li>IPv4 Subnet Calculator (GO library) <a href="https://github.com/brotherpowers/ipsubnet">https://github.com/brotherpowers/ipsubnet</a></li>

<li>convert-ipmask-to-ipaddr <a href="https://stackoverflow.com/questions/52448110/convert-ipmask-to-ipaddr">https://stackoverflow.com/questions/52448110/convert-ipmask-to-ipaddr</a></li>
</ul>
</div>
</div>


<div id="outline-container-org6b9bd4c" class="outline-2">
<h2 id="org6b9bd4c"><span class="section-number-2">17</span> Securing jenkins</h2>
<div class="outline-text-2" id="text-17">
<p>
<a href="https://github.com/jenkinsci/credentials-binding-plugin">https://github.com/jenkinsci/credentials-binding-plugin</a>
<a href="https://fedidat.com/270-jenkinsfile-scripted-secret-text/">https://fedidat.com/270-jenkinsfile-scripted-secret-text/</a>
<a href="https://www.jenkins.io/doc/pipeline/tour/environment/">https://www.jenkins.io/doc/pipeline/tour/environment/</a>
</p>


<p>
Environment variables <a href="http://albertoefg2c.mylabserver.com:8080/env-vars.html/">http://albertoefg2c.mylabserver.com:8080/env-vars.html/</a>
</p>
</div>
</div>


<div id="outline-container-org55fa451" class="outline-2">
<h2 id="org55fa451"><span class="section-number-2">18</span> Coverage</h2>
<div class="outline-text-2" id="text-18">
<p>
<a href="https://docs.sonarqube.org/latest/analysis/languages/go/">https://docs.sonarqube.org/latest/analysis/languages/go/</a>
<a href="https://docs.sonarqube.org/latest/analysis/coverage/">https://docs.sonarqube.org/latest/analysis/coverage/</a>
<a href="https://community.sonarsource.com/t/golang-code-coverage-difficulties/21348">https://community.sonarsource.com/t/golang-code-coverage-difficulties/21348</a>
<a href="https://stackoverflow.com/questions/10516662/how-to-measure-code-coverage-in-golang">https://stackoverflow.com/questions/10516662/how-to-measure-code-coverage-in-golang</a>
<a href="https://community.sonarsource.com/t/coverage-test-data-generate-reports-for-apex-c-c-objective-c-go-js-ts-and-python/9687">https://community.sonarsource.com/t/coverage-test-data-generate-reports-for-apex-c-c-objective-c-go-js-ts-and-python/9687</a>
</p>
</div>
</div>


<div id="outline-container-org1516c17" class="outline-2">
<h2 id="org1516c17"><span class="section-number-2">19</span> Junit testing for Jenkins</h2>
<div class="outline-text-2" id="text-19">
<p>
Jenkins has support for JUnit-style XML reports
<a href="https://www.jenkins.io/doc/pipeline/tour/tests-and-artifacts/">https://www.jenkins.io/doc/pipeline/tour/tests-and-artifacts/</a>
Golang repository to create them
<a href="https://github.com/jstemmer/go-junit-report">https://github.com/jstemmer/go-junit-report</a>
</p>

<div class="org-src-container">
<pre class="src src-shell"><span style="color: #8b94a5;"># </span><span style="color: #8b94a5;">install</span>
go get -u github.com/jstemmer/go-junit-report
<span style="color: #8b94a5;"># </span><span style="color: #8b94a5;">run</span>
go test -v <span style="color: #97365B; font-weight: bold;">2</span>&gt;&amp;<span style="color: #97365B; font-weight: bold;">1</span> | go-junit-report &gt; report.xml
<span style="color: #8b94a5;"># </span><span style="color: #8b94a5;">run with benchmark</span>
go test -v -bench . -count <span style="color: #97365B; font-weight: bold;">5</span> <span style="color: #97365B; font-weight: bold;">2</span>&gt;&amp;<span style="color: #97365B; font-weight: bold;">1</span> | go-junit-report &gt; report.xml
</pre>
</div>

<p>
After that we just create an step in jenkins to upload them
</p>
</div>
</div>

<div id="outline-container-org2c9672a" class="outline-2">
<h2 id="org2c9672a"><span class="section-number-2">20</span> Publishing</h2>
<div class="outline-text-2" id="text-20">
<p>
Package should include both <code>api</code> and <code>go.sum</code> files
<a href="https://blog.golang.org/using-go-modules">https://blog.golang.org/using-go-modules</a>
</p>

<blockquote>
<p>
The go command uses the go.sum file to ensure that future downloads of these modules retrieve the same bits as the first download, to ensure the modules your project depends on do not change unexpectedly, whether for malicious, accidental, or other reasons. Both go.mod and go.sum should be checked into version control.
</p>
</blockquote>


<p>
github-release <a href="https://github.com/github-release/github-release">https://github.com/github-release/github-release</a>
Upload build artifact to Github as release in Jenkins <a href="https://stackoverflow.com/questions/24585609/upload-build-artifact-to-github-as-release-in-jenkins">https://stackoverflow.com/questions/24585609/upload-build-artifact-to-github-as-release-in-jenkins</a>
</p>

<p>
GO build should be statically linked
</p>

<p>
This is for linux
</p>
<div class="org-src-container">
<pre class="src src-shell">$ env <span style="color: #842879;">CGO_ENABLED</span>=<span style="color: #97365B; font-weight: bold;">0</span> <span style="color: #842879;">GOOS</span>=linux <span style="color: #842879;">GOARCH</span>=amd64 go build -a -o app
</pre>
</div>

<p>
<a href="https://oddcode.daveamit.com/2018/08/16/statically-compile-golang-binary/">https://oddcode.daveamit.com/2018/08/16/statically-compile-golang-binary/</a>
<a href="https://www.arp242.net/static-go.html">https://www.arp242.net/static-go.html</a>
</p>
</div>



<div id="outline-container-orgd464b80" class="outline-3">
<h3 id="orgd464b80"><span class="section-number-3">20.1</span> NO longer possible to run binary only</h3>
<div class="outline-text-3" id="text-20-1">
<p>
<a href="https://golang.org/pkg/go/build/">https://golang.org/pkg/go/build/</a>
</p>
<blockquote>
<p>
"go build" and other commands no longer support binary-only-packages. Import and ImportDir will still set the BinaryOnly flag in packages containing these comments for use in tools and error messages.
</p>
</blockquote>
</div>
</div>
</div>



<div id="outline-container-org31c7e75" class="outline-2">
<h2 id="org31c7e75"><span class="section-number-2">21</span> - Notes</h2>
<div class="outline-text-2" id="text-21">
<ul class="org-ul">
<li><a href="https://www.redhat.com/architect/diagramming-tools-cloud-infrastructure">6 architectural diagramming tools for cloud infrastructure</a></li>
<li><a href="https://gitlab.com/redhatdemocentral/portfolio-architecture-examples">Portfolio Architecture Examples</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/devops/learn/agile/what-is-kanban">What is Kanban</a></li>
<li><a href="https://www.redhat.com/en/blog/integrating-ansible-jenkins-cicd-process">Integrating ansible with jenikns in a CI/CD process</a></li>
<li><a href="https://www.bantrain.com/how-to-setup-sonarqube-jenkins/">How to Setup Sonarqube &amp; Jenkins</a></li>

<li>jenkins and golang  <a href="https://plugins.jenkins.io/golang/">https://plugins.jenkins.io/golang/</a></li>
<li>goop <a href="https://github.com/karmakaze/goop">https://github.com/karmakaze/goop</a></li>
<li>goop error <a href="https://github.com/petejkim/goop/issues/44">https://github.com/petejkim/goop/issues/44</a></li>
<li>goop manual <a href="https://nicedoc.io/petejkim/goop">https://nicedoc.io/petejkim/goop</a></li>
<li>Go environment error <a href="https://stackoverflow.com/q/18149601">https://stackoverflow.com/q/18149601</a></li>
<li>Go environment variables  <a href="https://stackoverflow.com/a/49595197">https://stackoverflow.com/a/49595197</a></li>
<li>Go tests error <code>error during install strechr/testify, undefined: errors.Is</code>
<a href="https://github.com/stretchr/testify/issues/991">https://github.com/stretchr/testify/issues/991</a>
Fix with Go 1.13</li>
<li><a href="https://www.scalyr.com/blog/create-docker-image/">How To Create A Docker Image From A Container</a></li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2020-12-12 sáb 00:00</p>
<p class="author">Author: Alberto Flores</p>
<p class="date">Created: 2020-12-18 vie 14:12</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
